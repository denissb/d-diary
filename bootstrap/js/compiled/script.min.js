!function(a){a(function(){var c=a.support,b;a:{b=document.createElement("bootstrap");var d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},e;for(e in d)if(void 0!==b.style[e]){b=d[e];break a}b=void 0}c.transition=b&&{end:b}})}(window.jQuery);
!function(a){var c=function(b){a(b).on("click",'[data-dismiss="alert"]',this.close)};c.prototype.close=function(b){function d(){f.trigger("closed").remove()}var e=a(this),c=e.attr("data-target"),f;c||(c=(c=e.attr("href"))&&c.replace(/.*(?=#[^\s]*$)/,""));f=a(c);b&&b.preventDefault();f.length||(f=e.hasClass("alert")?e:e.parent());f.trigger(b=a.Event("close"));b.isDefaultPrevented()||(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.on(a.support.transition.end,d):d())};a.fn.alert=function(b){return this.each(function(){var d=
a(this),e=d.data("alert");e||d.data("alert",e=new c(this));"string"==typeof b&&e[b].call(d)})};a.fn.alert.Constructor=c;a(function(){a("body").on("click.alert.data-api",'[data-dismiss="alert"]',c.prototype.close)})}(window.jQuery);
!function(a){var c=function(b,d){this.$element=a(b);this.options=a.extend({},a.fn.button.defaults,d)};c.prototype.setState=function(a){var d=this.$element,e=d.data(),c=d.is("input")?"val":"html";a+="Text";e.resetText||d.data("resetText",d[c]());d[c](e[a]||this.options[a]);setTimeout(function(){"loadingText"==a?d.addClass("disabled").attr("disabled","disabled"):d.removeClass("disabled").removeAttr("disabled")},0)};c.prototype.toggle=function(){var a=this.$element.parent('[data-toggle="buttons-radio"]');
a&&a.find(".active").removeClass("active");this.$element.toggleClass("active")};a.fn.button=function(b){return this.each(function(){var d=a(this),e=d.data("button"),g="object"==typeof b&&b;e||d.data("button",e=new c(this,g));"toggle"==b?e.toggle():b&&e.setState(b)})};a.fn.button.defaults={loadingText:"loading..."};a.fn.button.Constructor=c;a(function(){a("body").on("click.button.data-api","[data-toggle^=button]",function(b){b=a(b.target);b.hasClass("btn")||(b=b.closest(".btn"));b.button("toggle")})})}(window.jQuery);
!function(a){function c(){a(b).parent().removeClass("open")}var b='[data-toggle="dropdown"]',d=function(b){var d=a(b).on("click.dropdown.data-api",this.toggle);a("html").on("click.dropdown.data-api",function(){d.parent().removeClass("open")})};d.prototype={constructor:d,toggle:function(b){b=a(this);var d;if(!b.is(".disabled, :disabled"))return d=b.attr("data-target"),d||(d=(d=b.attr("href"))&&d.replace(/.*(?=#[^\s]*$)/,"")),d=a(d),d.length||(d=b.parent()),b=d.hasClass("open"),c(),b||d.toggleClass("open"),
!1}};a.fn.dropdown=function(b){return this.each(function(){var c=a(this),f=c.data("dropdown");f||c.data("dropdown",f=new d(this));"string"==typeof b&&f[b].call(c)})};a.fn.dropdown.Constructor=d;a(function(){a("html").on("click.dropdown.data-api",c);a("body").on("click.dropdown",".dropdown form",function(a){a.stopPropagation()}).on("click.dropdown.data-api",b,d.prototype.toggle)})}(window.jQuery);
!function(a){function c(){var d=this,c=setTimeout(function(){d.$element.off(a.support.transition.end);b.call(d)},500);this.$element.one(a.support.transition.end,function(){clearTimeout(c);b.call(d)})}function b(a){this.$element.hide().trigger("hidden");d.call(this)}function d(b){var d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var c=a.support.transition&&d;this.$backdrop=a('<div class="modal-backdrop '+d+'" />').appendTo(document.body);"static"!=this.options.backdrop&&
this.$backdrop.click(a.proxy(this.hide,this));c&&this.$backdrop[0].offsetWidth;this.$backdrop.addClass("in");c?this.$backdrop.one(a.support.transition.end,b):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,a.proxy(e,this)):e.call(this)):b&&b()}function e(){this.$backdrop.remove();this.$backdrop=null}function g(){var b=this;if(this.isShown&&this.options.keyboard)a(document).on("keyup.dismiss.modal",
function(a){27==a.which&&b.hide()});else this.isShown||a(document).off("keyup.dismiss.modal")}var f=function(b,d){this.options=d;this.$element=a(b).delegate('[data-dismiss="modal"]',"click.dismiss.modal",a.proxy(this.hide,this))};f.prototype={constructor:f,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var b=this,c=a.Event("show");this.$element.trigger(c);this.isShown||c.isDefaultPrevented()||(a("body").addClass("modal-open"),this.isShown=!0,g.call(this),d.call(this,
function(){var d=a.support.transition&&b.$element.hasClass("fade");b.$element.parent().length||b.$element.appendTo(document.body);b.$element.show();d&&b.$element[0].offsetWidth;b.$element.addClass("in");d?b.$element.one(a.support.transition.end,function(){b.$element.trigger("shown")}):b.$element.trigger("shown")}))},hide:function(d){d&&d.preventDefault();d=a.Event("hide");this.$element.trigger(d);this.isShown&&!d.isDefaultPrevented()&&(this.isShown=!1,a("body").removeClass("modal-open"),g.call(this),
this.$element.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?c.call(this):b.call(this))}};a.fn.modal=function(b){return this.each(function(){var d=a(this),c=d.data("modal"),e=a.extend({},a.fn.modal.defaults,d.data(),"object"==typeof b&&b);c||d.data("modal",c=new f(this,e));if("string"==typeof b)c[b]();else e.show&&c.show()})};a.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0};a.fn.modal.Constructor=f;a(function(){a("body").on("click.modal.data-api",'[data-toggle="modal"]',
function(b){var d=a(this),c,e=a(d.attr("data-target")||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"")),d=e.data("modal")?"toggle":a.extend({},e.data(),d.data());b.preventDefault();e.modal(d)})})}(window.jQuery);
!function(a){var c=function(a,d){this.init("tooltip",a,d)};c.prototype={constructor:c,init:function(b,d,c){this.type=b;this.$element=a(d);this.options=this.getOptions(c);this.enabled=!0;"manual"!=this.options.trigger&&(b="hover"==this.options.trigger?"mouseenter":"focus",d="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(b,this.options.selector,a.proxy(this.enter,this)),this.$element.on(d,this.options.selector,a.proxy(this.leave,this)));this.options.selector?this._options=a.extend({},
this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(b){b=a.extend({},a.fn[this.type].defaults,b,this.$element.data());b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay});return b},enter:function(b){var d=a(b.currentTarget)[this.type](this._options).data(this.type);if(!d.options.delay||!d.options.delay.show)return d.show();clearTimeout(this.timeout);d.hoverState="in";this.timeout=setTimeout(function(){"in"==d.hoverState&&d.show()},d.options.delay.show)},
leave:function(b){var d=a(b.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!d.options.delay||!d.options.delay.hide)return d.hide();d.hoverState="out";this.timeout=setTimeout(function(){"out"==d.hoverState&&d.hide()},d.options.delay.hide)},show:function(){var a,d,c,g,f,h,k;if(this.hasContent()&&this.enabled){a=this.tip();this.setContent();this.options.animation&&a.addClass("fade");h="function"==typeof this.options.placement?this.options.placement.call(this,
a[0],this.$element[0]):this.options.placement;d=/in/.test(h);a.remove().css({top:0,left:0,display:"block"}).appendTo(d?this.$element:document.body);c=this.getPosition(d);g=a[0].offsetWidth;f=a[0].offsetHeight;switch(d?h.split(" ")[1]:h){case "bottom":k={top:c.top+c.height,left:c.left+c.width/2-g/2};break;case "top":k={top:c.top-f,left:c.left+c.width/2-g/2};break;case "left":k={top:c.top+c.height/2-f/2,left:c.left-g};break;case "right":k={top:c.top+c.height/2-f/2,left:c.left+c.width}}a.css(k).addClass(h).addClass("in")}},
isHTML:function(a){return"string"!=typeof a||"<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(a)},setContent:function(){var a=this.tip(),d=this.getTitle();a.find(".tooltip-inner")[this.isHTML(d)?"html":"text"](d);a.removeClass("fade in top bottom left right")},hide:function(){function b(){var b=setTimeout(function(){d.off(a.support.transition.end).remove()},500);d.one(a.support.transition.end,function(){clearTimeout(b);d.remove()})}var d=this.tip();d.removeClass("in");
a.support.transition&&this.$tip.hasClass("fade")?b():d.remove()},fixTitle:function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(b){return a.extend({},b?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a=this.$element,d=this.options;
return a.attr("data-original-title")||("function"==typeof d.title?d.title.call(a[0]):d.title)},tip:function(){return this.$tip=this.$tip||a(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.options=this.$element=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}};a.fn.tooltip=function(b){return this.each(function(){var d=
a(this),e=d.data("tooltip"),g="object"==typeof b&&b;e||d.data("tooltip",e=new c(this,g));if("string"==typeof b)e[b]()})};a.fn.tooltip.Constructor=c;a.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery);
!function(a){var c=function(a,d){this.init("popover",a,d)};c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype,{constructor:c,setContent:function(){var a=this.tip(),d=this.getContent();a.find(".popover-container")[this.isHTML(d)?"html":"text"](d);a.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var a=this.$element,d=this.options;return a.attr("data-content")||("function"==typeof d.content?d.content.call(a[0]):
d.content)},tip:function(){this.$tip||(this.$tip=a(this.options.template));return this.$tip}});a.fn.popover=function(b){return this.each(function(){var d=a(this),e=d.data("popover"),g="object"==typeof b&&b;e||d.data("popover",e=new c(this,g));if("string"==typeof b)e[b]()})};a.fn.popover.Constructor=c;a.fn.popover.defaults=a.extend({},a.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="popover-container"></div></div>'})}(window.jQuery);
!function(a){var c=function(b){this.element=a(b)};c.prototype={constructor:c,show:function(){var b=this.element,d=b.closest("ul:not(.dropdown-menu)"),c=b.attr("data-target"),g,f;c||(c=(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]*$)/,""));b.parent("li").hasClass("active")||(g=d.find(".active a").last()[0],f=a.Event("show",{relatedTarget:g}),b.trigger(f),f.isDefaultPrevented()||(c=a(c),this.activate(b.parent("li"),d),this.activate(c,c.parent(),function(){b.trigger({type:"shown",relatedTarget:g})})))},
activate:function(b,d,c){function g(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");b.addClass("active");h?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade");b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active");c&&c()}var f=d.find("> .active"),h=c&&a.support.transition&&f.hasClass("fade");h?f.one(a.support.transition.end,g):g();f.removeClass("in")}};a.fn.tab=function(b){return this.each(function(){var d=a(this),e=d.data("tab");e||d.data("tab",
e=new c(this));if("string"==typeof b)e[b]()})};a.fn.tab.Constructor=c;a(function(){a("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(b){b.preventDefault();a(this).tab("show")})})}(window.jQuery);
!function(a){var c=function(b,d){this.$element=a(b);this.options=a.extend({},a.fn.typeahead.defaults,d);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.$menu=a(this.options.menu).appendTo("body");this.source=this.options.source;this.shown=!1;this.listen()};c.prototype={constructor:c,select:function(){var a=this.$menu.find(".active").attr("data-value");
this.$element.val(this.updater(a)).change();return this.hide()},updater:function(a){return a},show:function(){var b=a.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:b.top+b.height,left:b.left});this.$menu.show();this.shown=!0;return this},hide:function(){this.$menu.hide();this.shown=!1;return this},lookup:function(b){var d=this;this.query=this.$element.val();if(!this.query)return this.shown?this.hide():this;b=a.grep(this.source,function(a){return d.matcher(a)});
b=this.sorter(b);return b.length?this.render(b.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){for(var d=[],c=[],g=[],f;f=a.shift();)f.toLowerCase().indexOf(this.query.toLowerCase())?~f.indexOf(this.query)?c.push(f):g.push(f):d.push(f);return d.concat(c,g)},highlighter:function(a){var d=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(RegExp("("+d+")","ig"),function(a,
b){return"<strong>"+b+"</strong>"})},render:function(b){var d=this;b=a(b).map(function(b,c){b=a(d.options.item).attr("data-value",c);b.find("a").html(d.highlighter(c));return b[0]});b.first().addClass("active");this.$menu.html(b);return this},next:function(b){b=this.$menu.find(".active").removeClass("active").next();b.length||(b=a(this.$menu.find("li")[0]));b.addClass("active")},prev:function(a){a=this.$menu.find(".active").removeClass("active").prev();a.length||(a=this.$menu.find("li").last());a.addClass("active")},
listen:function(){this.$element.on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this));if(a.browser.webkit||a.browser.msie)this.$element.on("keydown",a.proxy(this.keypress,this));this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this))},keyup:function(a){switch(a.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;
default:this.lookup()}a.stopPropagation();a.preventDefault()},keypress:function(a){if(this.shown){switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:if("keydown"!=a.type)break;a.preventDefault();this.prev();break;case 40:if("keydown"!=a.type)break;a.preventDefault();this.next()}a.stopPropagation()}},blur:function(a){var d=this;setTimeout(function(){d.hide()},150)},click:function(a){a.stopPropagation();a.preventDefault();this.select()},mouseenter:function(b){this.$menu.find(".active").removeClass("active");
a(b.currentTarget).addClass("active")}};a.fn.typeahead=function(b){return this.each(function(){var d=a(this),e=d.data("typeahead"),g="object"==typeof b&&b;e||d.data("typeahead",e=new c(this,g));if("string"==typeof b)e[b]()})};a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>'};a.fn.typeahead.Constructor=c;a(function(){a("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(b){var d=a(this);d.data("typeahead")||
(b.preventDefault(),d.typeahead(d.data()))})})}(window.jQuery);
!function(a){var c=function(b,d){this.$element=a(b);this.options=a.extend({},a.fn.collapse.defaults,d);this.options.parent&&(this.$parent=a(this.options.parent));this.options.toggle&&this.toggle()};c.prototype={constructor:c,dimension:function(){return this.$element.hasClass("width")?"width":"height"},show:function(){var b,d,c,g;if(!this.transitioning){b=this.dimension();d=a.camelCase(["scroll",b].join("-"));if((c=this.$parent&&this.$parent.find("> .accordion-group > .in"))&&c.length){if((g=c.data("collapse"))&&
g.transitioning)return;c.collapse("hide");g||c.data("collapse",null)}this.$element[b](0);this.transition("addClass",a.Event("show"),"shown");a.support.transition&&this.$element[b](this.$element[0][d])}},hide:function(){var b;this.transitioning||(b=this.dimension(),this.reset(this.$element[b]()),this.transition("removeClass",a.Event("hide"),"hidden"),this.$element[b](0))},reset:function(a){var d=this.dimension();this.$element.removeClass("collapse")[d](a||"auto")[0].offsetWidth;this.$element[null!==
a?"addClass":"removeClass"]("collapse");return this},transition:function(b,d,c){var g=this,f=function(){"show"==d.type&&g.reset();g.transitioning=0;g.$element.trigger(c)};this.$element.trigger(d);d.isDefaultPrevented()||(this.transitioning=1,this.$element[b]("in"),a.support.transition&&this.$element.hasClass("collapse")?this.$element.one(a.support.transition.end,f):f())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};a.fn.collapse=function(b){return this.each(function(){var d=
a(this),e=d.data("collapse"),g="object"==typeof b&&b;e||d.data("collapse",e=new c(this,g));if("string"==typeof b)e[b]()})};a.fn.collapse.defaults={toggle:!0};a.fn.collapse.Constructor=c;a(function(){a("body").on("click.collapse.data-api","[data-toggle=collapse]",function(b){var d=a(this),c;b=d.attr("data-target")||b.preventDefault()||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");c=a(b).data("collapse")?"toggle":d.data();d[a(b).hasClass("in")?"addClass":"removeClass"]("collapsed");a(b).collapse(c)})})}(window.jQuery);
!function(a){var c=function(b){this.element=a(b)};c.prototype={constructor:c,show:function(){var b=this.element,d=b.closest("ul:not(.dropdown-menu)"),c=b.attr("data-target"),g,f;c||(c=(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]*$)/,""));b.parent("li").hasClass("active")||(g=d.find(".active:last a")[0],f=a.Event("show",{relatedTarget:g}),b.trigger(f),f.isDefaultPrevented()||(c=a(c),this.activate(b.parent("li"),d),this.activate(c,c.parent(),function(){b.trigger({type:"shown",relatedTarget:g})})))},activate:function(b,
c,e){function g(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");b.addClass("active");h?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade");b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active");e&&e()}var f=c.find("> .active"),h=e&&a.support.transition&&f.hasClass("fade");h?f.one(a.support.transition.end,g):g();f.removeClass("in")}};a.fn.tab=function(b){return this.each(function(){var d=a(this),e=d.data("tab");e||d.data("tab",e=new c(this));
if("string"==typeof b)e[b]()})};a.fn.tab.Constructor=c;a(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(b){b.preventDefault();a(this).tab("show")})}(window.jQuery);$(document).ready(function(){window.err_msg=ui_lang.check_all_fields;$("#email-input").keydown(function(){is_valid_email($(this).val())?($(this).removeClass("error"),$(this).addClass("success")):(window.err_msg=ui_lang.invalid_email,$(this).removeClass("success"),$(this).addClass("error"))});$("#pass-input").keydown(function(){check_strength($(this))});$("#login-input").keydown(function(){3<$(this).val().length?($(this).removeClass("error"),$(this).addClass("success")):(window.err_msg=ui_lang.short_username,
$(this).removeClass("success"),$(this).addClass("error"))});confirm_val($("#email-confirm"));confirm_val($("#pass-confirm"));$("#signup").click(function(){5==$(".success").size()?$.ajax({type:"POST",url:"//ddiary.loc/signup/validate",data:{username:$("#login-input").val(),password:$("#pass-input").val(),email:$("#email-input").val(),terms:$("#agree-terms:checked").val(),capatcha:$("#capatcha-confirm").val()},success:function(a){"valid"==a?$("#registration").submit():$(".register").response(a,!1)},
fail:function(){$(".register").response(ui_lang.server_error,!1)}}):$(".register").response(window.err_msg,!1)});$("#refresh_capatcha").click(function(){$.ajax({type:"GET",url:"//ddiary.loc/signup/capatcha",success:function(a){$(".terms_td").children("img").replaceWith(a)},fail:function(){$(".register").response(ui_lang.server_error,!1)}})});$("#old-pass").keydown(function(){check_strength($(this))});$("#change_password").click(function(a){a.preventDefault();if(3>$(".success").size())$(".pass-change").response(window.err_msg,
!1);else{a=$("#old-pass").val();var c=$("#pass-input").val();a==c?($(".pass-change").response(ui_lang.pass_is_same,!1),$("#pass-input").removeClass("success"),$("#pass-input").addClass("error"),$(".icon-thumbs-up").remove()):$.ajax({type:"POST",url:"//ddiary.loc/settings/change_pass",dataType:"json",data:{old_pass:a,new_pass:c,new_pass_repeat:$("#pass-confirm").val()},success:function(a){$(".pass-change").response(a.msg,a.success);a.success&&($('input[type="password"]').val(""),$('input[type="password"]').removeClass("success"),
$(".icon-thumbs-up").remove())}})}})});function confirm_val(a){$(a).change(function(){var c="#"+$(this).attr("id").replace("confirm","input");a.val()==$(c).val()&&""!=$(this).val()?($(this).removeClass("error"),$(this).addClass("success")):($(this).removeClass("success"),$(this).addClass("error"),window.err_msg=ui_lang.invalid_confrimation)})}
function is_valid_email(a){return RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(a)}
function check_strength(a){var c=0,b=a.val();6<b.length?c+=1:window.err_msg=ui_lang.short_pass;b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(c+=1);b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)&&(c+=1);b.match(/([!,%,&,@,#,$,^,*,?,_,~])/)&&(c+=1);b.match(/(.*[!,%,&,@,#,$,^,*,?,_,~].*[!,",%,&,@,#,$,^,*,?,_,~])/)&&(c+=1);2>c?(a.removeClass("success"),window.err_msg=ui_lang.invalid_pass_combo,a.addClass("error"),$("#pass_result").remove()):2==c?(a.removeClass("error"),a.addClass("success"),$("#pass_result").remove()):
(a.removeClass("error"),a.addClass("success"),a.parent().append('<i class="icon-thumbs-up" id="pass_result"></i>'))}(function(a){jQuery.fn.response=function(a,b){var d="alert-error";!0==b&&(d="alert-success");this.before('<div class="alert '+d+'">'+a+'<a class="close" data-dismiss="alert" href="#">&times;</a></div>');setTimeout("$('.alert').alert('close');",7E3)}})(jQuery);(function(a,c,b){function d(a){return a}function e(a){return decodeURIComponent(a.replace(g," "))}var g=/\+/g,f=a.cookie=function(g,k,n){if(k!==b){n=a.extend({},f.defaults,n);null===k&&(n.expires=-1);if("number"===typeof n.expires){var s=n.expires,w=n.expires=new Date;w.setDate(w.getDate()+s)}k=f.json?JSON.stringify(k):String(k);return c.cookie=[encodeURIComponent(g),"=",f.raw?k:encodeURIComponent(k),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+
n.domain:"",n.secure?"; secure":""].join("")}k=f.raw?d:e;n=c.cookie.split("; ");s=0;for(w=n.length;s<w;s++){var x=n[s].split("=");if(k(x.shift())===g)return g=k(x.join("=")),f.json?JSON.parse(g):g}return null};f.defaults={};a.removeCookie=function(b,c){return null!==a.cookie(b)?(a.cookie(b,null,c),!0):!1}})(jQuery,document);(function(a){var c=window.localStorage,b;b="undefined"==typeof c||"undefined"==typeof window.JSON?!1:!0;a.totalStorage=function(b,c){return a.totalStorage.impl.init(b,c)};a.totalStorage.setItem=function(b,c){return a.totalStorage.impl.setItem(b,c)};a.totalStorage.getItem=function(b){return a.totalStorage.impl.getItem(b)};a.totalStorage.getAll=function(){return a.totalStorage.impl.getAll()};a.totalStorage.deleteItem=function(b){return a.totalStorage.impl.deleteItem(b)};a.totalStorage.impl={init:function(a,
b){return"undefined"!=typeof b?this.setItem(a,b):this.getItem(a)},setItem:function(d,e){if(!b)try{return a.cookie(d,e),e}catch(g){console.log("Local Storage not supported by this browser. Install the cookie plugin on your site to take advantage of the same functionality. You can get it at https://github.com/carhartl/jquery-cookie")}var f=JSON.stringify(e);c.setItem(d,f);return this.parseResult(f)},getItem:function(d){if(!b)try{return this.parseResult(a.cookie(d))}catch(e){return null}return this.parseResult(c.getItem(d))},
deleteItem:function(d){if(!b)try{return a.cookie(d,null),!0}catch(e){return!1}c.removeItem(d);return!0},getAll:function(){var d=[];if(b)for(g in c)g.length&&d.push({key:g,value:this.parseResult(c.getItem(g))});else try{for(var e=document.cookie.split(";"),g=0;g<e.length;g++){var f=e[g].split("=")[0];d.push({key:f,value:this.parseResult(a.cookie(f))})}}catch(h){return null}return d},parseResult:function(a){var b;try{b=JSON.parse(a),"true"==b&&(b=!0),"false"==b&&(b=!1),parseFloat(b)==b&&"object"!=typeof b&&
(b=parseFloat(b))}catch(c){}return b}}})(jQuery);(function(){var a;a=this.jQuery;this.Wysiwyg=function(){function c(b){var c,e;this.options=null!=b?b:{};this.el=a("<div />");e=this.options;for(c in e)b=e[c],this[c]=b;this.el.addClass(this.className);this.delegateEvents(this.events);this.render()}c.name="Wysiwyg";c.prototype.className="wysiwyg";c.prototype.events={"click [data-type=bold]":"bold","click [data-type=italic]":"italic","click [data-type=list]":"list","click [data-type=link]":"link","click [data-type=h2]":"h2","click [data-type=h3]":"h3",
"click a":"cancel"};c.prototype.document=document;c.prototype.render=function(){this.el.empty();this.el.append('<a href="#" data-type="bold" title="bold" class="btn btn-mini"><i class="icon-bold"></i></a>');this.el.append('<a href="#" data-type="list" title="list" class="btn btn-mini"><i class="icon-list-alt"></i></a>');this.el.append('<a href="#" data-type="link" title="link" class="btn btn-mini"><i class="icon-retweet"></a>');return this};c.prototype.bold=function(a){a.preventDefault();if(this.selectTest())return this.exec("bold")};
c.prototype.italic=function(a){a.preventDefault();if(this.selectTest())return this.exec("italic")};c.prototype.list=function(a){a.preventDefault();return this.exec("insertOrderedList")};c.prototype.link=function(a){a.preventDefault();if(this.selectTest()&&(this.exec("unlink"),(a=prompt("Enter a link:","http://"))&&"http://"!==a))return/:\/\//.test(a)||(a="http://"+a),this.exec("createLink",a)};c.prototype.h2=function(a){a.preventDefault();return"h2"===this.query("formatBlock")?this.exec("formatBlock",
"p"):this.exec("formatBlock","h2")};c.prototype.h3=function(a){a.preventDefault();return"h3"===this.query("formatBlock")?this.exec("formatBlock","p"):this.exec("formatBlock","h3")};c.prototype.move=function(a){return this.el.css(a)};c.prototype.cancel=function(a){a.preventDefault();return a.stopImmediatePropagation()};c.prototype.getSelectedText=function(){var a;if(null!=(a=this.document)&&a.selection)return document.selection.createRange().text;if(this.document)return document.getSelection().toString()};
c.prototype.selectTest=function(){return 0===this.getSelectedText().length?(alert("Select some text first."),!1):!0};c.prototype.exec=function(a,c){null==c&&(c=null);return this.document.execCommand(a,!1,c)};c.prototype.query=function(a){return this.document.queryCommandValue(a)};c.prototype.delegateEvents=function(a){var c,e,g,f,h,k=this;h=[];for(e in a)f=a[e],"function"!==typeof f&&(f=function(a){return function(){k[a].apply(k,arguments);return!0}}(f)),g=e.match(/^(\S+)\s*(.*)$/),c=g[1],g=g[2],
""===g?h.push(this.el.bind(c,f)):h.push(this.el.delegate(g,c,f));return h};return c}()}).call(this);(function(a){function c(a,c){for(var d=0,e=a.length;d<e;d++)if(a[d]==c)return!b;return b}var b=!1,d=parseFloat,e=String.fromCharCode,g=Math.min,f=/(-?\d+\.?\d*)$/g,h,k=[],n,s,w=9472,x={},H;Array.indexOf||(Array.prototype.indexOf=function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]==a)return b;return-1});for(var y=32,A=e(y);255>y;y++,A=e(y).toLowerCase())-1!==k.indexOf(A)&&k.push(A);k.sort();a.tinysort={id:"TinySort",version:"1.3.27",copyright:"Copyright (c) 2008-2012 Ron Valstar",uri:"http://tinysort.sjeiti.com/",
licenced:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},defaults:{order:"asc",attr:null,data:null,useVal:b,place:"start",returns:b,cases:b,forceStrings:b,sortFunction:null,charOrder:h}};a.fn.extend({tinysort:function(t,y){t&&"string"!=typeof t&&(y=t,t=null);var p=a.extend({},a.tinysort.defaults,y),G,A=a(this).length,q={},M=!(!t||""==t),S=!(null===p.attr||""==p.attr),T=null!==p.data,N=M&&":"==t[0],U=N?this.filter(t):this,r=p.sortFunction,O="asc"==
p.order?1:-1,P=[];if(p.charOrder!=h)if(h=p.charOrder){n=k.slice(0);s=!1;for(var u=[],B=function(a,b){u.push(b);x[p.cases?a:a.toLowerCase()]=b},v="",z="z",J=h.length,l,I,m=0;m<J;m++){var F=h[m],C=F.charCodeAt(),C=96<C&&123>C;if(!C)if("["==F){var Q=(l=u.length)?u[l-1]:z,D=h.substr(m+1).match(/[^\]]*/)[0],K=D.match(/{[^}]*}/g);if(K)for(l=0,I=K.length;l<I;l++){var L=K[l],m=m+L.length,D=D.replace(L,"");B(L.replace(/[{}]/g,""),Q);s=!0}l=0;for(I=D.length;l<I;l++)B(Q,D[l]);m+=D.length+1}else"{"==F?(l=h.substr(m+
1).match(/[^}]*/)[0],B(l,e(w++)),m+=l.length+1,s=!0):u.push(F);u.length&&(C||m===J-1)&&(l=u.join(""),v+=l,a.each(l,function(a,b){n.splice(n.indexOf(b),1)}),l=u.slice(0),l.splice(0,0,n.indexOf(z)+1,0),Array.prototype.splice.apply(n,l),u.length=0);m+1===J?H=RegExp("["+v+"]","gi"):C&&(z=F)}}else s=!1,w=9472,x={},H=n=null;r||(r="rand"==p.order?function(){return 0.5>Math.random()?1:-1}:function(a,c){var e=b,h=p.cases?a.s:a.s&&a.s.toLowerCase?a.s.toLowerCase():a.s,k=p.cases?c.s:c.s&&c.s.toLowerCase?c.s.toLowerCase():
c.s;if(!p.forceStrings){var l=h&&h.match(f),m=k&&k.match(f);if(l&&m){var r=h.substr(0,h.length-l[0].length),t=k.substr(0,k.length-m[0].length);r==t&&(e=!b,h=d(l[0]),k=d(m[0]))}}l=O*(h<k?-1:h>k?1:0);if(!e&&p.charOrder){if(s)for(var q in x)e=x[q],h=h.replace(q,e),k=k.replace(q,e);if(null!==h.match(H)||null!==k.match(H))for(q=0,e=g(h.length,k.length);q<e&&!(l=n.indexOf(h[q]),m=n.indexOf(k[q]),l=O*(l<m?-1:l>m?1:0));q++);}return l});this.each(function(b,c){var d=a(c),e=M?N?U.filter(c):d.find(t):d,f=T?
""+e.data(p.data):S?e.attr(p.attr):p.useVal?e.val():e.text(),g=d.parent();q[g]||(q[g]={s:[],n:[]});0<e.length?q[g].s.push({s:f,e:d,n:b}):q[g].n.push({e:d,n:b})});for(G in q)q[G].s.sort(r);for(G in q){var r=q[G],R=[],E=A,B=[0,0];switch(p.place){case "first":a.each(r.s,function(a,b){E=g(E,b.n)});break;case "org":a.each(r.s,function(a,b){R.push(b.n)});break;case "end":E=r.n.length;break;default:E=0}for(m=0;m<A;m++)v=c(R,m)?!b:m>=E&&m<E+r.s.length,z=(v?r.s:r.n)[B[v?0:1]].e,z.parent().append(z),!v&&p.returns||
P.push(z.get(0)),B[v?0:1]++}this.length=0;Array.prototype.push.apply(this,P);return this}});a.fn.TinySort=a.fn.Tinysort=a.fn.tsort=a.fn.tinysort})(jQuery);var config={home:"//ddiary.loc/"};config.popup=config.home+"ajax/showpopup";config.add_event=config.home+"ajax/addevent";config.events=config.home+"ajax/events";config.edit=config.home+"ajax/editevent";config.changedate=config.home+"ajax/changedate";config.remove=config.home+"ajax/delete";config.done=config.home+"ajax/done";config.not_done=config.home+"ajax/not_done";config.access=config.home+"ajax/access";config.loc=window.location.pathname.split("/");
3<config.loc.length&&(config.add_event+="/"+config.loc[3]+"/"+config.loc[4],config.events+="/"+config.loc[3]+"/"+config.loc[4]);
$(document).ready(function(){$.get(config.popup,function(a){$("div.temp").data("popup",a)});load_events($("#day-events"));$("div.cal-cell").popover({trigger:"manual",html:!0,content:function(){return $("div.temp").data("popup")}});$(".alert").alert();show_active_tab();$("div.cal-cell").click(function(){var a=$(this).find("div.day").html();$(".calendar .cal-cell").not(this).popover("hide");!1==$(this).hasClass("cal-active")?load_events($("#day-events"),a):($(this).popover("toggle"),$(".popover-content .details").hide(),
ready_time($("input#time")));$(".calendar .cal-cell").removeClass("cal-active");$(this).addClass("cal-active")});$(".close-popover").live("click",function(){$(".calendar .cal-cell").popover("hide");$(".popover-content .details").hide()});$(document).keyup(function(a){27==a.keyCode&&($(".calendar .cal-cell").popover("hide"),$(".popover-content .details").hide())});$(".show-details").live("click",function(a){a.preventDefault();$(".popover-content .details").toggle();0==$("div.wysiwyg").length&&(a=new Wysiwyg,
$(".area").before(a.el));$(this).children("i").toggleClass("icon-chevron-down");$(this).children("i").toggleClass("icon-chevron-up")});$("#add-event").live("click",function(a){a.preventDefault();a=$("div.cal-active").find(".day").html();var c=$("input.time_p").val(),b=$("input.event_p").val(),d=$("div.area").text();""!=a&""!=b?$.ajax({type:"POST",url:config.add_event,dataType:"json",data:{day:a,time:c,event:b,description:d},success:function(a){"Added"==a.result?(change_count("+"),$(".popover-add").response(ui_lang.cal_added,
!0),$("p.event-info").remove(),add_event(a.id,c,b,d),$("div#event-conteiner > div").tsort("span.time"),$(".close-popover").trigger("click")):$(".popover-add").response(a.result,!1)},fail:function(){$(".popover-add").response(ui_lang.server_side_error,!1)}}):$(".popover-add").response(ui_lang.cal_no_values,!1)});$("button.show-desc").live("click",function(){$(this).parent(".description").toggleClass("closed");$(this).children("i").toggleClass("icon-chevron-down");$(this).children("i").toggleClass("icon-chevron-up")});
$("button.toggle-cal").live("click",function(){$("tbody#cal-body").toggle();$(this).children("i").toggleClass("icon-chevron-up");$(this).children("i").toggleClass("icon-chevron-down");hide_cal_body("tbody#cal-body")});$("button.edit-event").live("click",function(){$(this).removeClass("edit-event btn-primary");$(this).addClass("btn-success save-event");$(this).html(ui_lang.save);var a=$(this).parents(":eq(2)");a.find("span.time").attr("contentEditable","true").forcetime();a.find("h3.event-name").attr("contentEditable",
"true");var c=a.find("div.desc-field");0<c.length?(a.find("div.description").removeClass("closed"),c.attr("contentEditable","true"),0==$("div.wysiwyg").length&&(a=new Wysiwyg,c.before(a.el))):(a.append('<div class="description"><div class="desc-field" contentEditable="true"></div></div>'),0==$("div.wysiwyg").length&&(a=new Wysiwyg,$("div.desc-field").before(a.el)))});$("a.delete-event").live("click",function(){var a=$(this).parents(":eq(4)"),c=a.find("button.edit-event").attr("id");void 0!=c?$.ajax({type:"POST",
url:config.remove,data:{id:c},success:function(b){"deleted"==b?(a.parent().response(ui_lang.cal_evt_deleted,!0),change_count("-"),a.remove()):a.response(ui_lang.cal_error_del,!1)},fail:function(){alert(ui_lang.fail)}}):alert(ui_lang.finish_editing)});$("a.done-event").live("click",function(){var a=$(this).parents(":eq(4)"),c=a.find("button.edit-event").attr("id");void 0!=c?$.ajax({type:"POST",url:config.done,data:{id:c},success:function(b){"done"==b?(a.find("h3.event-name").addClass("event-done"),
a.find("a.done-event").addClass("hide"),a.find("a.not-done-event").removeClass("hide")):a.response(b,!1)},fail:function(){alert(ui_lang.fail)}}):alert(ui_lang.finish_editing)});$("a.not-done-event").live("click",function(){var a=$(this).parents(":eq(4)"),c=a.find("button.edit-event").attr("id");void 0!=c?$.ajax({type:"POST",url:config.not_done,data:{id:c},success:function(b){"done"==b?(a.find("h3.event-name").removeClass("event-done"),a.find("a.done-event").removeClass("hide"),a.find("a.not-done-event").addClass("hide")):
a.response(b,!1)},fail:function(){alert(ui_lang.fail)}}):alert(ui_lang.finish_editing)});$("button.save-event").live("click",function(){var a=$(this).parents(":eq(2)");time_el=a.find("span.time");event_el=a.find("h3.event-name");desc_el=a.find("div.desc-field");var c=$(this).attr("id"),b=$("h2#active-date").html().slice(0,-1),d=time_el.html(),e=event_el.html(),g=desc_el.html(),f=$(this);""!=b&""!=e?$.ajax({type:"POST",url:config.edit,data:{id:c,day:b,time:d,data:e,description:g},success:function(b){switch(b){case "error":a.response(ui_lang.cal_couldnt_save,
!1);time_el.attr("contentEditable","false");event_el.attr("contentEditable","false");desc_el.attr("contentEditable","false");f.removeClass("save-event btn-success");f.addClass("btn-primary edit-event");f.html(ui_lang.edit);break;case "reserved":a.response(ui_lang.cal_time_reserved);break;default:time_el.attr("contentEditable","false"),event_el.attr("contentEditable","false"),desc_el.attr("contentEditable","false"),$("div.wysiwyg").remove(),f.removeClass("save-event btn-success"),f.addClass("btn-primary edit-event"),
f.html(ui_lang.edit),$("div#event-container > div").tsort("span.time")}},fail:function(){a.response(ui_lang.fail,!1);time_el.attr("contentEditable","false");event_el.attr("contentEditable","false");desc_el.attr("contentEditable","false")}}):alert(ui_lang.no_values);desc_button()});$(document).on("hover",".change-event",function(){$(this).datepicker("show");$(document).on("hover",".delete-event",function(){$(".change-event").datepicker("hide")});$(document).on("hover",".done-event",function(){$(".change-event").datepicker("hide")});
$(this).datepicker().on("changeDate",function(a){var c=$(this).parents(":eq(4)"),b=c.find("button.edit-event").attr("id"),d=getFormatedDate(a.date);if(void 0!=b){if(a.date.getTime()==getSelDate().getTime())return!1;$.ajax({type:"POST",url:config.changedate,data:{id:b,newdate:d},success:function(b){"changed"==b?(c.parent().response(ui_lang.cal_date_changed+d,!0),change_count("-"),a.date.getMonth()==getSelDate().getMonth()&&find_increment(a.date.getDate()),c.remove()):c.response(ui_lang.cal_error_change,
!1)},fail:function(){alert(ui_lang.fail)}})}else alert(ui_lang.finish_editing);$(this).datepicker("hide");a.stopPropogation()})});$("#show-add").live("click",function(){$("#event-container").hide();$(".calendar .cal-cell").popover("hide");$("#add-section").fadeIn("fast");if(0==$("div.wysiwyg").length){var a=new Wysiwyg;$(".area").before(a.el)}$(this).hide();ready_time($("input#time"))});$("#hide-add").live("click",function(a){a.preventDefault();$("div.wysiwyg").remove();$("#add-section").hide();$("#show-add").fadeIn("fast");
$("#event-container").fadeIn("fast")});$("#main-add").live("click",function(a){a.preventDefault();a=$("h2#active-date").html().slice(0,-1);var c=$("#time").val(),b=$("#event").val(),d=$("div.area")[0].innerHTML;""!=a&""!=b?$.ajax({type:"POST",url:config.add_event,dataType:"json",data:{day:a,time:c,event:b,description:d},success:function(a){"Added"==a.result?(change_count("+"),add_event(a.id,c,b,d),$("p.event-info").remove(),$("div#event-container > div").tsort("span.time"),$("#hide-add").trigger("click"),
$("div#event-container").response(ui_lang.cal_added,!0)):$(".popover-add").response(a.result,!1)},fail:function(){$(".popover-add").response(ui_lang.server_side_error,!1)}}):$(".popover-add").response(ui_lang.no_values,!1)});$("form :input").change(function(){$(this).closest("form").data("changed",!0)});$("ul.nav-tabs li a").click(function(){$.totalStorage("opened_tab",$(this).attr("href"))});$("#userSettings").click(function(a){a.preventDefault();a=$("#user_settings");if($(this).closest("form").data("changed")){var c=
!1;$.each(a.find("input"),function(){if(""==this.value||void 0==this.value)c=!0});c?$("#user_settings").response(ui_lang.no_values,!1):(a=$("#user_settings"),a.attr("action",config.home+"settings/process_user"),a.submit())}else $("#user_settings").response(ui_lang.no_change,!1)});$("a.bt_hide").live("click",function(a){a.preventDefault();a=$(this).attr("href");$(a).toggle();$(a).next().toggle();$(this).children("i").toggleClass("icon-chevron-up");$(this).children("i").toggleClass("icon-chevron-down");
set_hidden(a)});$("#delete_acc_button").click(function(){if(confirm(ui_lang.delete_acc))window.location="http://ddiary.loc/logout/app/delete";else return!1});$("#access_log").click(function(){$.get(config.access,function(a){a=eval(a);a[0].message||(2>$("#accessTable tr").length&&a.forEach(function(a){$("#accessTable").append("<tr><td>"+a.ip+"</td><td>"+a.time+"</td><td>"+a.client+"</td></tr>")}),$("#accessModal").modal("show"))})})});
jQuery.fn.forcetime=function(){return this.each(function(){$(this).focusout(function(){""==this.innerHTML&&(this.innerHTML="0:00")});$(this).keydown(function(a){a=a.charCode||a.keyCode||0;return 8==a||9==a||46==a||186==a||37<=a&&40>=a||48<=a&&57>=a||96<=a&&105>=a})})};function hide_hidden(){var a=$.totalStorage("hidden_sections");if($.isArray(a))for(var c in a)$(a[c]).hide(),$(a[c]).next().hide(),$("a[href$="+a[c]+"]").children("i").attr("class","icon-chevron-down")}
function set_hidden(a){var c=[],c=$.totalStorage("hidden_sections");$.isArray(c)?-1==$.inArray(a,c)?c.push(a):(a=c.indexOf(a),c.splice(a,1)):(c=[],c.push(a));$.totalStorage("hidden_sections",c)}
function change_count(a,c){var b=$(".cal-active").find("span.events");if(0<b.length){var d=b.text(),d=parseInt(d);"-"==a?d--:d++;0<d?b.text(d):($(".cal-active").find("span.events").remove(),c=$(".cal-active").find("div.day"),c.hasClass("bold")||c.addClass("no-events"))}else $(".cal-active").find("div.day").removeClass("no-events"),$(".cal-active").append('<span class="events">1</span>')}
jQuery.fn.response=function(a,c){var b="alert-error";!0==c&&(b="alert-success");this.prepend('<div class="alert '+b+'">'+a+'<a class="close" data-dismiss="alert" href="#">&times;</a></div>');setTimeout("$('.alert').alert('close');",5E3)};
function load_events(a,c){null==c&&(c=$("div.cal-active").find("div.day").html());$("#day-events").html('<div class="progress progress-striped active"><div class="bar"></div></div>');""!=c?$.ajax({type:"POST",url:config.events,data:{day:c},success:function(b){a.html(b);desc_button();$("#day-events").trigger("data_fetch")},fail:function(){a.html("<p>"+ui_lang.server_side_error+"</p>")}}):alert(ui_lang.no_values)}
function desc_button(){$("div.desc-field").each(function(){60<$(this).height()?0==$(this).parent().find("button.show-desc").length&&$(this).before('<button class="btn show-desc" title="details.."><i class="icon-chevron-down"></i></button>'):$(this).parent().find("button.show-desc").remove();""==$(this).text()&&($(this).parent().remove(),$(this).remove())})}
function add_event(a,c,b,d){""==c&&(c="0:00");var e=getFormatedDate(getSelDate());a='<div class="event-item"><div class="controlls"><div class="btn-group"><button class="btn btn-primary edit-event" id="'+a+'">'+ui_lang.edit+'</button><button class="btn dropdown-toggle btn-primary" data-toggle="dropdown"><span class="caret"></span></button><ul class="dropdown-menu"><li><a href="#" class="done-event">'+ui_lang.done+'</a></li><li><a href="#" class="change-event" data-date-format="yyyy-mm-dd" data-date="'+
e+'">'+ui_lang.change_date+'</a></li><li class="divider"></li><li><a href="#" class="delete-event">'+ui_lang["delete"]+"</a></li></ul></div></div>";a+='<span class="time">'+c+'</span><h3 class="event-name">&nbsp;'+b+"</h3>";""!=d&&(a+='<div class="description closed"><div class="desc-field">'+d+"</div></div>");a+="</div>";$("div#event-container").append(a)}
function ready_time(a){a.focus().typeahead({source:"00:00 1:00 2:00 3:00 4:00 5:00 6:00 7:00 8:00 9:00 10:00 11:00 12:00 13:00 14:00 15:00 16:00 17:00 18:00 19:00 20:00 21:00 22:00 23:00 1:10 1:20 1:30 1:40 1:50 2:10 2:20 2:30 2:40 2:50 3:10 3:20 3:30 3:40 3:50 4:10 4:20 4:30 4:40 4:50 5:10 5:20 5:30 5:40 5:50 6:10 6:20 6:30 6:40 6:50 7:10 7:20 7:30 7:40 7:50 8:10 8:20 8:30 8:40 8:50 9:10 9:20 9:30 9:40 9:50 10:10 10:20 10:30 10:40 10:50 11:10 11:20 11:30 11:40 11:50 12:10 12:20 12:30 12:40 12:50 13:10 13:20 13:30 13:40 13:50 14:10 14:20 14:30 14:40 14:50 15:10 15:20 15:30 15:40 15:50 16:10 16:20 16:30 16:40 16:50 17:10 17:20 17:30 17:40 17:50 18:10 18:20 18:30 18:40 18:50 19:10 19:20 19:30 19:40 19:50 20:10 20:20 20:30 20:40 20:50 21:10 21:20 21:30 21:40 21:50 22:10 22:20 22:30 22:40 22:50 23:10 23:20 23:30 23:40 23:50".split(" "),items:"6"});
a.forcetime()}function getSelDate(){var a=$(".cal-active").find("div.day").html(),c=$("table.calendar").attr("id"),b=c.match(/[0-9]{4}/),c=c.match(/[0-9]{2}$/);return null!=a?new Date(b,c-1,a):new Date}function getFormatedDate(a){var c=a.getDate(),b=a.getMonth()+1;return a.getFullYear()+"-"+b+"-"+c}function hasScrollBar(){return $("body").outerHeight()>$(window).height()}
function find_increment(a){a=$("#cal-body").find("div.day:textEquals('"+a+"')");a.removeClass("no-events");events=a.parent().find("span.events");0<events.length?(a=events.text(),a=parseInt(a),a++,events.text(a)):a.parent().append('<span class="events">1</span>')}function show_active_tab(){var a=$.totalStorage("opened_tab");void 0!=a?$('.nav-tabs a[href="'+a+'"]').tab("show"):$(".nav-tabs a:first").tab("show")}$.expr[":"].textEquals=function(a,c,b){return(a=$(a).text().match("^"+b[3]+"$"))&&0<a.length};
